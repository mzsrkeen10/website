---
title: "CODE THANKS FESTIVAL 2018参加記"
slug: "thanks-2018"
date: 2018-11-25T22:51:00+09:00
draft: false
categories: ["競プロ"]
tags: ["AtCoder", "CODE THANKS FESTIVAL", "参加記"]
---

AtCoderの[CODE THANKS FESTIVAL](https://beta.atcoder.jp/contests/code-thanks-festival-2018)に参加しました．企業コンオンサイトは3回目で，THANKSは初めてです．

<!--more-->

### 予選

予選Aが369位，予選Bが202位でした．微妙な結果でしたが，繰り上げでギリギリTHANKSに通りました．

### 本選

10:40ぐらいに会場に着きました．蟻本を忘れました．  
![](/images/post/2018-11-25-thanks/picture1.JPG)
交通費の精算をしたあと，大量に置かれていたお菓子の中からじゃがりこを取って席に着きました．
お弁当が出現したので取ろうと思ったら，開会式の後に取ってくださいと言われました．
あと，chokudaiさんがAtCoderステッカーを配っていたので，ありがたく貰っておきました，

11:30からの開会式が終わったあと，叙々苑の焼肉弁当を取りました．
焼肉弁当と言いつつ漬物の占有面積が大きかったので，漬物を食べていたらコンテストが始まってしまいました．
上位50人がパーカーを貰えるそうです．

### 問題

[A問題](https://beta.atcoder.jp/contests/code-thanks-festival-2018-open/tasks/code_thanks_festival_2018_a)  
条件演算子でやろうとしたら思ったより分岐が多かったので諦めてif文に直しました．

* * *

[B問題](https://beta.atcoder.jp/contests/code-thanks-festival-2018-open/tasks/code_thanks_festival_2018_b)  
赤い玉を1個，青い玉を3個箱から取り出す操作をA,赤い玉を3個，青い玉を1個箱から取り出す操作をBと呼ぶことにします．  
パッと見で，どちらの操作でも合計4個玉が減ることと，両方の色が少なくとも1個減ることに気づきましたが，
それを使った解法がいまいちまとまらなかったので連立方程式を立てて解きました．  
操作Aをa回行い，操作Bをb回行ったとすると，
$$
\begin{aligned}
    a + 3b & = X \\\ 3a + b & = Y
\end{aligned}
$$
これを解くと，
$$
    a = \frac{3Y-X}{8}, b = \frac{3X-Y}{8}
$$
となるので，a,bが非負整数になれば良いです．

* * *

[C問題](https://beta.atcoder.jp/contests/code-thanks-festival-2018-open/tasks/code_thanks_festival_2018_c)  
単純にペアを列挙すると間に合わないので，とりあえずソートします．  
左から数えて(0-indexedで)i番目の人とi+1番目の人の間の領域に注目します．
この領域よりも左側にはi+1人，右側にはN-i-1人が住んでいるので，
総和を考えた時，この領域は(i+1) * (N-i-1)回足されることになります．
![](/images/post/2018-11-25-thanks/problemC.png)
よって，この領域の長さをdとすれば，全てのiについて(i+1) * (N-i-1) * dを計算して足せば良いです．  
オーバーフローに気をつけましょう（1WA

* * *

[D問題](https://beta.atcoder.jp/contests/code-thanks-festival-2018-open/tasks/code_thanks_festival_2018_d)  
アルファベット順で最小の文字を持ちながら前から見ていけばokです．

* * *

[E問題](https://beta.atcoder.jp/contests/code-thanks-festival-2018-open/tasks/code_thanks_festival_2018_e)  
出来る操作は2つのXを1つのX+1に変更することだけです．  
なので，黒板に書かれている最小の数字をmとすると，mが奇数個書かれていた場合，
黒板からmを無くすことは出来ません．  
また，黒板にiが1個だけ書かれている状況を考えた時，この状況になるのは

- 最初から黒板にiが1個だけ書かれていた
- 1つ前の状態では黒板にi-1が2つ書かれていた

の2通りの場合しかありません．
ここから，黒板にiを1個だけ残す組み合わせの総数は，黒板にyを1個だけ書く方法の通り数（1通り）と，
黒板にi-1が書かれる通り数の2つから求められそうだと思いました．  
iが1個ではなく複数個書かれている場合について，似たような方法で考えると

- 最初から黒板にiがk個書かれている
- 黒板にi-1がj個書かれている状態から(j/2)個のiを作る

の2種類の方法でiを作ることが出来ます．  
これらのことから，

**dp[i][j] := 「黒板にiがj個書かれる組み合わせの総数」**

というDPを考えました．  
0は黒板に書けないので，1を0から作ることは出来ません．
なので，1が書かれる組み合わせの総数は初期値として与えておく必要があります．
また，1以上T以下全ての整数に対して，黒板にそれを1個だけ書く場合の数も初期値として与えます．  
初期化はこんな感じです．
```C++
for(int j=0;j<=a[1];++j){
    dp[1][j] = 1;
}
for(int i=1;i<=t;++i){
    dp[i][1] = min(1, a[i]);
}
```
遷移ですが，iが最後の1個になる場合を除いて，k+(j/2)は偶数であって欲しいです．
また，iが最後の1個になる場合は2個のi-1からiを1個作ります．
よって，k+(j/2)が偶数になる時と，2個のi-1からiを1個作る(j==2 && k==0)時，以下の遷移を行います．
```C++
dp[i][k+j/2] += dp[i-1][j]
```
DPのループは以下のような感じになります．
```C++
for(int i=2;i<M;++i){
    for(int j=0;j<M;j+=2){
        for(int k=0;k<=a[i];++k){
            if((k+j/2) % 2 == 0 || j == 2 && k == 0){
                dp[i][k+j/2] += dp[i-1][j];
                dp[i][k+j/2] %= mod;
            }
        }
    }
}
```
Mは「黒板に書かれる可能性のある最大の整数」です．

このDPを行った後，\\(1 \le i \le M \\)に対してdp[i][1]を足し上げれば求める答えになり・・・ならない！なんで！？  
本番中はなぜかサンプル3が合わず2時間ぐらいずっとデバッグしてました．
DPに苦手意識があるのでDP部分を疑ってたんですが，
何が間違ってるのか分からず，手で考えられる小さいコーナーケースも見つからず，
とりあえず全探索のコードを書き始めるも全探索がバグってしまい．．．  
といった感じで苦しんだ結果コンテストが終了しました．
（デバッグ中にやっと焼き肉を食べました．）

解説で黒板に書かれる可能性のある最大の整数の話が出てきた時に，
僕がこれを小さく見積もりすぎていたことに気付きました．
というのも，コンテスト中はなぜか黒板には合計で300個の数字しか書かれていないと思い込んでおり，
300が300個書いてあるのが最大ケースだと思ってMを見積もっていたのです．
実際，コンテスト中に書いたコードのMを大きくしたら通りました．
なぜサンプル3を見て何も気付かないのか・・・  
これを通していたらパーカーが貰えたかもしれなかっただけに物凄くショックでした．
このショックでF~Hの解説は聞いてませんでした．
Hの解説で「中央値は二分探索」って言ってたのだけ覚えてます．

### 懇親会

懇親会ではコネクションビンゴというものをやりました．
25マスのビンゴで，それぞれのマスに質問が書かれており，
質問への回答が一致する人が居たらそのマスを埋めることが出来ます．
より速くビンゴを達成した30人は景品としてレポートパッドが貰えました．
また，全マスを埋めた人には特別賞としてAmazon Echoが贈られました(確か)．

懇親会中はご飯や飲み物，お菓子が提供されて，自由に飲み食いできました．

僕はビンゴを達成した後はずっと知り合いと喋ってたんですが，
もっと色んな人と交流を図ればよかったなあと思います．

懇親会のお菓子や飲み物がかなり余っていたので，帰る時に皆に配っていました．

### 終わりに

競プロをやるのはかなり久々で楽しさを忘れかけていたんですが，
今回CODE THANKS FESTIVALに参加して競プロの楽しさを思い出すことが出来ました．
個人的には悔しさの残る結果でしたが，やっぱりオンサイトコンテストは楽しいので，
また参加できるように精進したいです．

最後に，戦利品の写真を載せておきます．
![](/images/post/2018-11-25-thanks/picture2.JPG)
